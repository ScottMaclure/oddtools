{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "App.svelte"
  ],
  "sourcesContent": [
    "<script>\n\texport let appData\n\texport let ifData\n\n\tlet selectedLevel = ifData.classes.magicUser.levels[0]\n\tlet selectedIntelligence = ifData.abilities.intelligence[4]\n\tlet spellBook = deepClone(ifData.classes.magicUser.startingSpellBook)\n\n\tfunction resetSpellBook() {\n\t\tconsole.log('resetSpellBook called')\n\t\tspellBook = deepClone(ifData.classes.magicUser.startingSpellBook)\n\t}\n\t\n\tfunction generateSpellBook() {\n\t\t\n\t\t// Reset the spellbook\n\t\tresetSpellBook()\n\t\tconsole.log('generateSpellBook, selectedIntelligence:', selectedIntelligence)\n\n\t\t// Go through each level up to the selected class level, generating spells.\n\t\tfor (let i = 0; i < selectedLevel.level; i++) {\n\n\t\t\tconsole.log('Generating spells for level:', i+1)\n\t\t\t\n\t\t\tlet currentSpells = spellBook[i].spells\n\t\t\tlet spellsAvailable = deepClone(ifData.classes.magicUser.spells[i])\n\n\t\t\tif (i == 0) {\n\t\t\t\t// FIXME Read Magic is already in the list... so filter it out for generation.\n\t\t\t\tspellsAvailable = spellsAvailable.filter(item => item !== \"Read Magic\")\n\t\t\t}\n\n\t\t\tconsole.log('currentSpells:', currentSpells)\n\t\t\tconsole.log('spellsAvailable:', spellsAvailable)\n\n\t\t\tlet moreSpells = true\n\t\t\twhile (moreSpells) {\n\t\t\t\t// 0) Did we run out of spellsAvailable for this level?\n\t\t\t\tif (spellsAvailable.length === 0) {\n\t\t\t\t\tmoreSpells = false\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 1) Too many spells already?\n\t\t\t\tif (currentSpells.length >= selectedIntelligence.maxNum) {\n\t\t\t\t\tmoreSpells = false\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 2) Too few spells? Add a new one immediately.\n\t\t\t\tif (currentSpells.length < selectedIntelligence.minNum) {\n\t\t\t\t\tlet newSpell = getUniqueSpell(currentSpells, spellsAvailable)\n\t\t\t\t\tcurrentSpells.push(newSpell)\n\t\t\t\t\t// Remove this spell from the list\n\t\t\t\t\tspellsAvailable = spellsAvailable.filter(item => item !== newSpell)\n\t\t\t\t\tmoreSpells = true\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 3) Inbetween min and max? Roll to add another spell\n\t\t\t\t// TODO Confirm this logic with IF - random or sequential?\n\t\t\t\t// i.e. \"stopping when all have been checked or the Max # number has been reached\"\n\t\t\t\tlet newSpell = getUniqueSpell(currentSpells, spellsAvailable)\n\t\t\t\tif (roll1d100() <= selectedIntelligence.spellChance) {\n\t\t\t\t\tcurrentSpells.push(newSpell)\n\t\t\t\t}\n\t\t\t\t// Remove this item regardless of spellChance, as per IF p.134\n\t\t\t\tspellsAvailable = spellsAvailable.filter(item => item !== newSpell)\n\t\t\t\tmoreSpells = true\n\t\t\t\tcontinue\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction getUniqueSpell(currentSpells, spellsAvailable) {\n\t\tlet keepGoing = true\n\t\twhile (keepGoing) {\n\t\t\tlet newSpell = randomArrayItem(spellsAvailable)\n\t\t\tif (!currentSpells.includes(newSpell)) {\n\t\t\t\tkeepGoing = false\n\t\t\t\treturn newSpell\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction randomArrayItem(arr) {\n\t\tconst idx = Math.floor(Math.random() * arr.length)\n\t\treturn arr[idx]\n\t}\n\n\tfunction roll1d100() {\n\t\treturn randomInteger(1, 100)\n\t}\n\n\tfunction randomInteger(min, max) {\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n\t}\n\n\tfunction deepClone(obj) {\n\t\treturn JSON.parse(JSON.stringify(obj))\n\t}\n\n</script>\n\n<div class=\"container\">\n\n\t<div class=\"item\">\n\n\t\t<header>\n\t\t\t<h1>{appData.title}</h1>\n\t\t\t<p>Misc tools for playing OD&D by way of Iron Falcon.</p>\n\t\t</header>\n\n\t\t<main>\n\t\t\t<h2>Extended Spell List</h2>\n\n\t\t\t<fieldset>\n\t\t\t\t<legend>Configure</legend>\n\t\t\t\t<div>\n\t\t\t\t\tCharacter Level:\n\t\t\t\t\t<select bind:value={selectedLevel} on:blur={resetSpellBook}>\n\t\t\t\t\t\t{#each ifData.classes.magicUser.levels as option}\n\t\t\t\t\t\t\t<option value={option}>{option.level}</option>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div>\n\t\t\t\t\tIntelligence:\n\t\t\t\t\t<select bind:value={selectedIntelligence}>\n\t\t\t\t\t\t{#each ifData.abilities.intelligence as option}\n\t\t\t\t\t\t\t{#if option.levelMin === option.levelMax}\n\t\t\t\t\t\t\t\t<option value={option}>{option.levelMax}</option>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<option value={option}>{option.levelMin}-{option.levelMax}</option>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</select>\n\t\t\t\t\t\n\t\t\t\t\t<div><small>\n\t\t\t\t\t\tLevel={selectedLevel.level}, \n\t\t\t\t\t\tExperience={selectedLevel.experience}, \n\t\t\t\t\t\tChance={selectedIntelligence.spellChance}%, \n\t\t\t\t\t\tMin={selectedIntelligence.minNum}, \n\t\t\t\t\t\tMax={selectedIntelligence.maxNum}, \n\t\t\t\t\t\tMaxLevel={selectedIntelligence.maxLevel}.\n\t\t\t\t\t</small></div>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</fieldset>\n\n\t\t\t<button on:click={generateSpellBook}>Generate Spellbook</button>\n\n\t\t\t<fieldset id=\"spellBook\">\n\t\t\t\t<legend>Level {selectedLevel.level} Magic-User's Spellbook</legend>\n\t\t\t\t{#each spellBook as spellBookLevel}\n\t\t\t\t\t{#if spellBookLevel.spells.length > 0}\n\t\t\t\t\t<div>Level {spellBookLevel.level}: {spellBookLevel.spells.join(', ')}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{/each}\n\t\t\t</fieldset>\n\n\t\t</main>\n\n\t\t<footer>\n\t\t\t<small>&copy; 2020 Scott Maclure. MIT License. Version {appData.version}. <a href=\"{appData.ghRepo}\">Github repo</a>.</small>\n\t\t</footer>\n\n\t</div>\n\n</div>\n\n<style>\n\t.container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n\n\t.container > .item {\n\t\tmax-width: 768px;\n\t}\n\n\th1 {\n\t\tcolor: #ff3e00;\n\t\ttext-transform: uppercase;\n\t\tfont-size: 4em;\n\t\tfont-weight: 100;\n\t}\n\n\tmain {\n\t\ttext-align: left;\n\t}\n\n\tfooter {\n\t\tmargin-top: 1rem;\n\t}\n\n\t@media (min-width: 640px) {\n\t\t.container {\n\t\t\tmax-width: none;\n\t\t}\n\t}\n</style>"
  ],
  "names": [],
  "mappings": "AA8KC,UAAU,8BAAC,CAAC,AACX,OAAO,CAAE,IAAI,CACb,cAAc,CAAE,MAAM,CACtB,WAAW,CAAE,MAAM,AACpB,CAAC,AAED,yBAAU,CAAG,KAAK,eAAC,CAAC,AACnB,SAAS,CAAE,KAAK,AACjB,CAAC,AAED,EAAE,8BAAC,CAAC,AACH,KAAK,CAAE,OAAO,CACd,cAAc,CAAE,SAAS,CACzB,SAAS,CAAE,GAAG,CACd,WAAW,CAAE,GAAG,AACjB,CAAC,AAED,IAAI,8BAAC,CAAC,AACL,UAAU,CAAE,IAAI,AACjB,CAAC,AAED,MAAM,8BAAC,CAAC,AACP,UAAU,CAAE,IAAI,AACjB,CAAC,AAED,MAAM,AAAC,YAAY,KAAK,CAAC,AAAC,CAAC,AAC1B,UAAU,8BAAC,CAAC,AACX,SAAS,CAAE,IAAI,AAChB,CAAC,AACF,CAAC"
}